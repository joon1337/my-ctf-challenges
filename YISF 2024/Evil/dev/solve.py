import string
from pwn import *

def phase1():
    key = [12, 31, 29, 33, 85, 37, 6, 102, 60, 62, 44, 56, 84, 31, 42, 43, 66, 7, 29, 90, 85, 44, 79, 20, 50, 64, 18, 3, 119, 54, 49, 55, 28, 46, 6, 68, 22, 75, 92, 52, 67, 105, 12, 68, 46, 59, 88, 92, 15, 72, 14, 95, 65, 122, 35, 92, 52, 16, 17, 45, 59, 59, 34, 8, 85, 20, 25, 72, 47, 6, 52, 68, 28, 86, 100, 67, 50, 25]
    table = [91, 122, 113, 66, 58, 72, 99, 71, 99, 118, 77, 78, 49, 64, 83, 68, 55, 88, 110, 53, 57, 90, 42, 112, 109, 52, 122, 102, 40, 84, 94, 90, 126, 113, 100, 33, 112, 36, 46, 81, 124, 54, 69, 34, 113, 66, 55, 41, 80, 44, 103, 59, 109, 37, 74, 40, 107, 103, 126, 88, 87, 95, 125, 106, 48, 75, 124, 41, 92, 127, 107, 34, 115, 36, 59, 58, 93, 108]

    print(xor(key, table))
    
def phase2():
    print("abbabaa")

def phase3():
    diff = [33, 8, 24, 22, 22, 2, 12, 14, 3, 3, 2, 12, 2, 8, 6, 27, 33, 4, 19, 12, 60, 72, 12, 3, 6, 5, 1, 14, 1, 2, 3, 10, 20, 13, 19, 16, 9, 7, 24, 8, 3, 6, 8, 15]

    table = list(map(ord, string.printable))

    check = lambda x: x>=32 and x<=126 and x in [44, 68, 73, 78, 95, 97, 98, 99, 100, 101, 102, 104, 108, 109, 111, 114, 115, 116, 119, 121]

    l = [ord('N')]

    def find(l, idx):
            if len(l) == 45:
                    temp = 0
                    for i in l:
                            temp ^= i
                    if temp == 43:
                            print(''.join(map(chr, l)))
                    return
            lst = l.copy()
            if check(lst[-1] + diff[idx]):
                    lst.append(lst[-1] + diff[idx])
                    find(lst, idx+1)
                    lst.pop()
            if check(lst[-1] - diff[idx]):
                    lst.append(lst[-1] - diff[idx])
                    find(lst, idx+1)
                    lst.pop()

    find(l, 0)

phase1()
phase2()
phase3()