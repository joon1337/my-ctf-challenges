from pwn import *
name = b"y15f2025"
key = b"312a-91ac-41ca-5132"
FLAG = b"6eb5632b9271329694aa196d7f27eb0ccd653407bfa45271efe86433747c02f75a761b8c35a62a48bade6853b9fd46f43b82edaf9d53e939388202634f541da9"

assert len(name) == 8
assert len(key) == 19

SUM = sum([u32(v) for v in key.split(b"-")])
assert xor(name, p32(SUM & 0xffffffff)) == b"\xac\xf5\x1c>\xe7\xf4\x1bm"

_name = [u32(name[:4]), u32(name[4:])]
_serial = [u32(v) for v in key.split(b"-")]
xor_key = [
    124, 101, 101, 50, 61, 50, 97, 52, 116, 50, 97, 54, 52, 51, 56, 49,
    115, 52, 102, 102, 58, 56, 101, 50, 122, 102, 100, 48, 98, 99, 49, 100,
    41, 100, 49, 50, 56, 53, 99, 97, 47, 102, 55, 51, 50, 51, 54, 54,
    47, 102, 98, 63, 61, 53, 96, 101, 122, 52, 97, 100, 55, 51, 103, 48,
    127, 97, 48, 49, 58, 99, 107, 53, 126, 53, 55, 49, 53, 96, 53, 63,
    40, 97, 99, 98, 61, 57, 102, 101, 47, 57, 48, 99, 51, 55, 103, 51,
    121, 98, 63, 53, 110, 101, 50, 48, 116, 100, 99, 52, 98, 56, 50, 62,
    121, 56, 63, 53, 59, 51, 101, 101, 121, 102, 99, 51, 54, 101, 96, 62
]

_serial[0] ^= _name[0]
_serial[1] ^= _name[1]
_serial[2] ^= _name[0]
_serial[3] ^= _name[1]

assert FLAG == (xor(xor_key, b"".join(map(p32, _serial))))
